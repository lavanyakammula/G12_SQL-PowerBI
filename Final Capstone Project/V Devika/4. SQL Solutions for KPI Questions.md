# SQL Solutions for KPI Questions

1. **How many distinct courses are there in each subject category?**
   
    ```sql
    SELECT subject, COUNT(DISTINCT course_title) AS distinct_courses
    FROM udemy
    GROUP BY subject;
    ```

2. **What is the total revenue generated by each subject category?**
   
    ```sql
    SELECT subject, SUM(profit) AS total_profit
    FROM udemy
    GROUP BY subject
    ORDER BY total_profit DESC;
    ```

3. **Which subject category has the highest average number of subscribers per course?**
   
    ```sql
    SELECT subject, AVG(num_subscribers) AS avg_num_subscribers
    FROM udemy
    GROUP BY subject
    ORDER BY avg_num_subscribers DESC
    LIMIT 1;
    ```

4. **How does the enrollment count vary between paid and free courses?**
    
    ```sql
    SELECT is_paid, COUNT(num_subscribers)
    FROM udemy
    GROUP BY is_paid;
    ```

5. **What is the average review rating for courses in each subject category?**
   
    ```sql
    SELECT subject, AVG(reviews_avg)
    FROM udemy
    GROUP BY subject;
    ```

6. **Which difficulty level is most common across all courses?**
   
    ```sql
    SELECT course_level, COUNT(*)
    FROM udemy
    GROUP BY course_level
    ORDER BY COUNT(*) DESC
    LIMIT 1;
    ```

7. **Courses with titles containing 'SQL' and number of subscribers over the year**
   
    ```sql
    SELECT course_title, year, SUM(num_subscribers)
    FROM udemy
    WHERE course_title LIKE '%SQL%'
    GROUP BY course_title, year;
    ```

8. **Subject categories with the most courses published in each year**
   
    ```sql
    SELECT year, subject, course_count
    FROM (
        SELECT year, subject, COUNT(course_title) AS course_count,
               ROW_NUMBER() OVER(PARTITION BY year ORDER BY COUNT(course_title) DESC) AS rn
        FROM udemy
        GROUP BY year, subject
    ) AS ranked
    WHERE rn = 1
    ORDER BY year;
    ```

9. **Top 10 Courses with more than 1000 subscribers and price range above or equal to 100?**
   
    ```sql
    SELECT course_title, num_subscribers, price
    FROM udemy
    WHERE num_subscribers > 1000 AND price >= 100
    ORDER BY price DESC;
    ```

10. **How many course prices are between 0-50, 51-100, 101-150, 151-200?**
   
    ```sql
    SELECT CASE
               WHEN price BETWEEN 0 AND 50 THEN '0-50'
               WHEN price BETWEEN 51 AND 100 THEN '51-100'
               WHEN price BETWEEN 101 AND 150 THEN '101-150'
               WHEN price BETWEEN 151 AND 200 THEN '151-200'
           END AS price_range,
           COUNT(*)
    FROM udemy
    GROUP BY price_range
    ORDER BY price_range DESC;
    ```
